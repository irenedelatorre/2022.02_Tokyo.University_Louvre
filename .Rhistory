f5A_Louvre_MIT_1_2017_12) %>%
mutate(
user_id = ID,
id_ap_2 = ACCESS_POINT_HOSTNAME,
ip_address = ACCESS_POINT_IP_ADDRESS,
date = DATE,
start = TIME_DEB,
end = TIME_END,
duration = TIME_DUR,
weekday = WEEKDAY
)
f5_Louvre_MIT_ <- f5_Louvre_MIT_ %>% mutate(
user_id = ID,
id_ap_2 = ACCESS_POINT_HOSTNAME,
ip_address = ACCESS_POINT_IP_ADDRESS,
date = DATE,
start = TIME_DEB,
end = TIME_END,
duration = TIME_DUR,
weekday = WEEKDAY
)
View(f5_Louvre_MIT_)
f5A_Louvre_MIT_1_2017_11 <- read_csv(
paste0(source,"Users.Locations/Louvre_MIT(11-2017)_v1.csv"))
f5A_Louvre_MIT_1_2017_12 <- read_csv(
paste0(source,"Users.Locations/Louvre_MIT(12-2017)_v2.csv"))
f5A_Louvre_MIT_1_2018 <- read_csv(
paste0(source,"Users.Locations/Louvre_MIT(1-2018)_v3.csv"))
f5_Louvre_MIT <- rbind(
f5A_Louvre_MIT_1_2018,
f5A_Louvre_MIT_1_2017_11,
f5A_Louvre_MIT_1_2017_12) %>%
rename(
user_id = ID,
id_ap_2 = ACCESS_POINT_HOSTNAME,
ip_address = ACCESS_POINT_IP_ADDRESS,
date = DATE,
start = TIME_DEB,
end = TIME_END,
duration = TIME_DUR,
weekday = WEEKDAY
)
remove(f5_Louvre_MIT_)
## f8 = f5 + f6
# pick single names of the id_ap_2
f7_ap_ids <- f5_Louvre_MIT %>%
group_by(id_ap_2) %>%
tally()
View(f7_ap_ids)
## f8 = f5 + f6
# pick single names of the id_ap_2
f7_ap_ids <- f5_Louvre_MIT %>%
group_by(id_ap_2) %>%
tally() %>%
mutate(id_ap_3 = nrow())
## f8 = f5 + f6
# pick single names of the id_ap_2
f7_ap_ids <- f5_Louvre_MIT %>%
group_by(id_ap_2) %>%
tally() %>%
mutate(id_ap_3 = nrow)
## f8 = f5 + f6
# pick single names of the id_ap_2
f7_ap_ids <- f5_Louvre_MIT %>%
group_by(id_ap_2) %>%
tally() %>%
mutate(id_ap_3 = row_number())
## f8 = f5 + f6
# pick single names of the id_ap_2
f7_ap_ids <- f5_Louvre_MIT %>%
group_by(id_ap_2) %>%
tally() %>%
mutate(id_ap_3 = row_number()) %>%
select(c(id_ap_2, id_ap_3))
f8_rooms_ap_ids <- merge(
f6_id_1_2_matched,
f7_ap_ids,
by = "id_ap_2"
)
View(f8_rooms_ap_ids)
f8_rooms_ap_ids <- merge(
f6_id_1_2_matched,
f7_ap_ids,
by = "id_ap_2",
all=T
)
f6_id_1_2_matched <- merge(
f3_WiFi_rename_miyajima_200528fin,
f4_WIFI_LOUVRE_TRUE,
by = "mac",
all=T)
View(f6_id_1_2_matched)
f6_total <- length(f6_id_1_2_matched)
f6_total
f6_total <- nrow(f6_id_1_2_matched)
# count missmatches
f6_id_1_2_matched <- f6_id_1_2_matched %>%
drop_na()
message(f6_total - f6_id_1_2_matched, " out of ", f6_total, " lost")
message(paste0(f6_total - f6_id_1_2_matched, " out of ", f6_total, " lost"))
message(paste0(f6_total - nrow(f6_id_1_2_matched), " out of ", f6_total, " lost"))
message(paste0(f6_total - nrow(f6_id_1_2_matched), " out of ", f6_total, " access points lost"))
remove(f6_total)
f8_rooms_ap_ids <- merge(
f6_id_1_2_matched,
f7_ap_ids,
by = "id_ap_2",
all=T
)
f8_total <- nrow(f8_rooms_ap_ids)
f8_rooms_ap_ids <- f8_rooms_ap_ids %>%
drop_na()
message(
paste0(
f8_total - nrow(f8_rooms_ap_ids),
" out of ",
f8_total,
" access points lost")
)
remove(f8_total)
View(f8_rooms_ap_ids)
f8_rooms_ap_ids <- merge(
f8_rooms_ap_ids,
f2_Louvre_network_Wi_Fi_miyajima_200528fin,
by = "id_ap_1"
)
select(c(id_ap_3, Room_Number, location)
)
f9_ap_rooms <- f8_rooms_ap_ids %>%
select(c(id_ap_3, Room_Number, location))
View(f9_ap_rooms)
id_room <- f8_rooms_ap_ids %>%
select(c(id_ap_2, id_ap_3))
f5_Louvre_MIT <- merge(
f5_Louvre_MIT,
id_room,
by = "id_ap_2",
all = T
)
f5_total <- 0
createUser <- function(data) {
data <- data %>%
rename(
user_id = ID,
id_ap_2 = ACCESS_POINT_HOSTNAME,
ip_address = ACCESS_POINT_IP_ADDRESS,
date = DATE,
start = TIME_DEB,
end = TIME_END,
duration = TIME_DUR,
weekday = WEEKDAY
)
data <- merge(
data,
id_room,
by = "id_ap_2",
all = T
)
f5_total <- f5_total + nrow(data)
data
}
f10_Louvre_MIT_1_2017_11 <- createUser(f5A_Louvre_MIT_1_2017_11)
View(f10_Louvre_MIT_1_2017_11)
nrow(f10_Louvre_MIT_1_2017_11)
remove(f5_Louvre_MIT)
f10_Louvre_MIT_1_2017_12 <- createUser(f5A_Louvre_MIT_1_2017_12)
library(readr)
library(readxl)
library(dplyr)
source <- "../network_data/"
f1_Louvre_network <- read_csv(
paste0(source, "Rooms.Matrix/Louvre_network.csv")
)
# Room data --------------------------------------------------------------------
f2_Louvre_network_Wi_Fi_miyajima_200528fin <- read_excel(
paste0(
source,
"Rooms.Access.Points/Louvre_network+Wi-Fi_miyajima_200528fin.xlsx"
)
) %>%
rename(id_ap_1 = "ID_Access_Point")
f3_WiFi_rename_miyajima_200528fin <- read_excel(
paste0(
source,
"Rooms.Access.Points/Wi-Fi_rename_miyajima_200528fin.xlsx"
)
) %>%
rename(id_ap_1 = "No.") %>%
select(c(id_ap_1, memo, mac))
f4_WIFI_LOUVRE_TRUE <- read_excel(
paste0(source, "Rooms.Access.Points/WIFI_LOUVRE_TRUE.xlsx")
) %>%
rename(
id_ap_2 = Borne,
mac_eth = "MAC ETH",
mac_radio = "range MAC Radio",
location = "Emplacement") %>%
select(c(id_ap_2, mac_eth, mac_radio, location))
View(f2_Louvre_network_Wi_Fi_miyajima_200528fin)
View(f3_WiFi_rename_miyajima_200528fin)
strtoi("48C093")
strtoi(C("48C093"))
strtoi(c("48C093"))
strtoi(c("0x48C093"))
f5A_Louvre_MIT_1_2017_11 <- read_csv(
paste0(source,"Users.Locations/Louvre_MIT(11-2017)_v1.csv"))
f5A_Louvre_MIT_1_2017_12 <- read_csv(
paste0(source,"Users.Locations/Louvre_MIT(12-2017)_v2.csv"))
f5A_Louvre_MIT_1_2018 <- read_csv(
paste0(source,"Users.Locations/Louvre_MIT(1-2018)_v3.csv"))
f5_Louvre_MIT <- rbind(
f5A_Louvre_MIT_1_2018,
f5A_Louvre_MIT_1_2017_11,
f5A_Louvre_MIT_1_2017_12) %>%
rename(
user_id = ID,
id_ap_2 = ACCESS_POINT_HOSTNAME,
ip_address = ACCESS_POINT_IP_ADDRESS,
date = DATE,
start = TIME_DEB,
end = TIME_END,
duration = TIME_DUR,
weekday = WEEKDAY
)
library(dplyr)
library(tidyr)
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(mac = toupper(mac))
View(f4_WIFI_LOUVRE_TRUE)
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(mac = toupper(mac)) %>%
mutate(mac = gsub(':', ''))
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(mac = toupper(mac)) %>%
mutate(mac = gsub(':', '', mac))
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(mac = toupper(mac)) %>%
mutate(
mac = gsub(':', '', mac),
radio = gsub(':', '', radio))
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = paste0("0x", gsub(':', '', mac)),
radio_hex = paste0("0x", gsub(':', '', radio)))
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = strtoi(paste0("0x", gsub(':', '', mac))),
radio_hex = strtoi(paste0("0x", gsub(':', '', radio)))
)
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = (paste0("0x", gsub(':', '', mac))),
radio_hex = strtoi(paste0("0x", gsub(':', '', radio)))
)
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
# mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = strtoi(paste0("0x", gsub(':', '', mac))),
radio_hex = strtoi(paste0("0x", gsub(':', '', radio)))
)
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
# mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = (paste0("0x", gsub(':', '', mac))),
radio_hex = strtoi(paste0("0x", gsub(':', '', radio)))
)
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
# mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = (paste0("0x", gsub(':', '', mac))),
radio_hex = strtoi(paste0("0x", gsub(':', '', radio)))
)
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
# mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = strtoi(paste0("0x", gsub(':', '', mac))),
radio_hex = strtoi(paste0("0x", gsub(':', '', radio)))
)
strtoi(0x506028889d80)
strtoi(506028889d80)
strtoi("506028889d80")
strtoi("0x506028889d80")
summary(f4_WIFI_LOUVRE_TRUE)
f4_WIFI_LOUVRE_TRUE$mac
strtoi("0x506028")
strtoi("0x506028be")
strtoi("0x506028be03")
strtoi("0x03")
strtoi("0x506028be0d")
strtoi("0x506028be82")
strtoi("0x506028be8")
strtoi("0x506028be2")
## f6 = f3 + f4 ----- merge by mac id ------------------------------------------
## f4 --> mac_radio: 48:c0:93:00:42:28-00:42:37
## f3 --> mac:       48:C0:93:00:42:28
## f3 + f4 = mac_radio until dash and in uppercase
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
# mutate(mac = toupper(mac)) %>%
mutate(
mac_hex = as.numeric(paste0("0x", gsub(':', '', mac))),
radio_hex = as.numeric(paste0("0x", gsub(':', '', radio)))
)
View(f3_WiFi_rename_miyajima_200528fin)
f3_WiFi_rename_miyajima_200528fin <- f3_WiFi_rename_miyajima_200528fin %>%
mutate(mac_hex = as.numeric(paste0("0x", gsub(':', '', mac))))
f3_WiFi_rename_miyajima_200528fin <- read_excel(
paste0(
source,
"Rooms.Access.Points/Wi-Fi_rename_miyajima_200528fin.xlsx"
)
) %>%
rename(id_ap_1 = "No.") %>%
select(c(id_ap_1, memo, mac))
f3_WiFi_rename_miyajima_200528fin <- read_excel(
paste0(
source,
"Rooms.Access.Points/Wi-Fi_rename_miyajima_200528fin.xlsx"
)
) %>%
rename(id_ap_1 = "No.") %>%
select(c(id_ap_1, memo, mac)) %>%
drop_na(id_ap_1)
f3_WiFi_rename_miyajima_200528fin <- f3_WiFi_rename_miyajima_200528fin %>%
mutate(mac_hex = as.numeric(paste0("0x", gsub(':', '', mac))))
f6_id_1_2_matched <- merge(
f3_WiFi_rename_miyajima_200528fin,
f4_WIFI_LOUVRE_TRUE,
by = "mac_hex",
all = T)
View(f6_id_1_2_matched)
print(item)
for (i in nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[, i]
print(item)
}
item <- f3_WiFi_rename_miyajima_200528fin[,]
for (i in nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[,]
print(item)
}
for (i in nrow(f3_WiFi_rename_miyajima_200528fin)) {
print(i)
item <- f3_WiFi_rename_miyajima_200528fin[,]
print(item)
}
for (i in nrow(f3_WiFi_rename_miyajima_200528fin)) {
print(i)
item <- f3_WiFi_rename_miyajima_200528fin[,]
#print(item)
}
for (i in 1:nrow(f3_WiFi_rename_miyajima_200528fin)) {
print(i)
item <- f3_WiFi_rename_miyajima_200528fin[,]
#print(item)
}
for (i in 1:nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[,i]
print(item)
}
for (i in 1:nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[i, ]
print(item)
}
for (i in 1:nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[i, ]
item_mac <- item$mac_hex
this_f4 <- f4_WIFI_LOUVRE_TRUE %>%
filter(mac_hex - radio <= item_mac & item_mac <= mac_hex + radio)
message(this_f4)
}
for (i in 1:nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[i, ]
item_mac <- item$mac_hex
this_f4 <- f4_WIFI_LOUVRE_TRUE %>%
filter((mac_hex - radio) <= item_mac & item_mac <= (mac_hex + radio))
message(this_f4)
}
f4_WIFI_LOUVRE_TRUE <- f4_WIFI_LOUVRE_TRUE %>%
mutate(new_mac = mac_radio) %>%
separate(new_mac, c("mac", "radio"), "-") %>%
mutate(
mac_hex = as.numeric(paste0("0x", gsub(':', '', mac))),
radio_hex = as.numeric(paste0("0x", gsub(':', '', radio))),
upper_bound = mac_hex + radio_hex,
lower_bound = mac_hex - radio_hex
)
for (i in 1:nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[i, ]
item_mac <- item$mac_hex
this_f4 <- f4_WIFI_LOUVRE_TRUE %>%
filter(lower_bound <= item_mac & item_mac <= upper_bound)
message(this_f4)
}
View(f3_WiFi_rename_miyajima_200528fin)
for (i in 1:nrow(f3_WiFi_rename_miyajima_200528fin)) {
item <- f3_WiFi_rename_miyajima_200528fin[i, ]
item_mac <- item$mac_hex
this_f4 <- f4_WIFI_LOUVRE_TRUE %>%
filter(lower_bound <= item_mac & item_mac <= upper_bound)
message(nrow(this_f4))
}
f6_id_1_2_matched <- merge(
f3_WiFi_rename_miyajima_200528fin,
f4_WIFI_LOUVRE_TRUE,
by = "mac_hex",
all = T)
for (i in 1:nrow(f6_id_1_2_matched)) {
item <- f6_id_1_2_matched[i, ]
message(item)
# item_mac <- item$mac_hex
#
# this_f4 <- f4_WIFI_LOUVRE_TRUE %>%
#   filter(lower_bound <= item_mac & item_mac <= upper_bound)
#
# message(nrow(this_f4))
}
View(f6_id_1_2_matched)
for (i in 1:nrow(f6_id_1_2_matched)) {
item <- f6_id_1_2_matched[i, ]
if(is.Na(item$id_ap_1)) {
message(item)
}
# item_mac <- item$mac_hex
#
# this_f4 <- f4_WIFI_LOUVRE_TRUE %>%
#   filter(lower_bound <= item_mac & item_mac <= upper_bound)
#
# message(nrow(this_f4))
}
for (i in 1:nrow(f6_id_1_2_matched)) {
item <- f6_id_1_2_matched[i, ]
if(is.na(item$id_ap_1)) {
message(item)
}
# item_mac <- item$mac_hex
#
# this_f4 <- f4_WIFI_LOUVRE_TRUE %>%
#   filter(lower_bound <= item_mac & item_mac <= upper_bound)
#
# message(nrow(this_f4))
}
